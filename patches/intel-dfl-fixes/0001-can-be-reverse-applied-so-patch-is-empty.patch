--- a/debian/patches/gardenlinux/00-dfl_support/0001-fpga-m10bmc-sec-Fix-probe-rollback.patch	2023-02-27 15:59:22.829900197 +0100
+++ b/debian/patches/gardenlinux/00-dfl_support/0001-fpga-m10bmc-sec-Fix-probe-rollback.patch	2023-02-27 15:59:22.829900197 +0100
@@ -1,56 +0,0 @@
-From 51c3fb11ac0693beb3355b6bdd127ef026a9f034 Mon Sep 17 00:00:00 2001
-From: =?UTF-8?q?Ilpo=20J=C3=A4rvinen?= <ilpo.jarvinen@linux.intel.com>
-Date: Tue, 10 Jan 2023 10:35:21 +0200
-Subject: [PATCH] fpga: m10bmc-sec: Fix probe rollback
-MIME-Version: 1.0
-Content-Type: text/plain; charset=UTF-8
-Content-Transfer-Encoding: 8bit
-
-Handle probe error rollbacks properly to avoid leaks.
-
-Fixes: 5cd339b370e2 ("fpga: m10bmc-sec: add max10 secure update functions")
-Reviewed-by: Matthew Gerlach <matthew.gerlach@linux.intel.com>
-Reviewed-by: Russ Weight <russell.h.weight@intel.com>
-Reviewed-by: Marco Pagani <marpagan@redhat.com>
-Signed-off-by: Ilpo JÃ¤rvinen <ilpo.jarvinen@linux.intel.com>
----
- drivers/fpga/intel-m10-bmc-sec-update.c | 17 ++++++++++++-----
- 1 file changed, 12 insertions(+), 5 deletions(-)
-
-diff --git a/drivers/fpga/intel-m10-bmc-sec-update.c b/drivers/fpga/intel-m10-bmc-sec-update.c
-index 79d48852825e..03f1bd81c434 100644
---- a/drivers/fpga/intel-m10-bmc-sec-update.c
-+++ b/drivers/fpga/intel-m10-bmc-sec-update.c
-@@ -574,20 +574,27 @@ static int m10bmc_sec_probe(struct platform_device *pdev)
- 	len = scnprintf(buf, SEC_UPDATE_LEN_MAX, "secure-update%d",
- 			sec->fw_name_id);
- 	sec->fw_name = kmemdup_nul(buf, len, GFP_KERNEL);
--	if (!sec->fw_name)
--		return -ENOMEM;
-+	if (!sec->fw_name) {
-+		ret = -ENOMEM;
-+		goto fw_name_fail;
-+	}
- 
- 	fwl = firmware_upload_register(THIS_MODULE, sec->dev, sec->fw_name,
- 				       &m10bmc_ops, sec);
- 	if (IS_ERR(fwl)) {
- 		dev_err(sec->dev, "Firmware Upload driver failed to start\n");
--		kfree(sec->fw_name);
--		xa_erase(&fw_upload_xa, sec->fw_name_id);
--		return PTR_ERR(fwl);
-+		ret = PTR_ERR(fwl);
-+		goto fw_uploader_fail;
- 	}
- 
- 	sec->fwl = fwl;
- 	return 0;
-+
-+fw_uploader_fail:
-+	kfree(sec->fw_name);
-+fw_name_fail:
-+	xa_erase(&fw_upload_xa, sec->fw_name_id);
-+	return ret;
- }
- 
- static int m10bmc_sec_remove(struct platform_device *pdev)
